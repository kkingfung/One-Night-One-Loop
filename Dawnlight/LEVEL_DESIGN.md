# Dawnlight - Level Design Document

## Night 1 Demo Edition

**Version**: 0.1.0
**Last Updated**: 2025-01-16

---

## 1. レベルデザインコンセプト

### 1.1 設計哲学

> 「すべての空間が選択を迫る」

- **光と影の境界** = 選択の瞬間
- **見通しの制限** = 緊張の持続
- **複数経路** = プレイヤーの agency
- **隠れ場所の戦略的配置** = リスクリワード

### 1.2 Night 1 テーマ

**「監視施設の廃墟」**
- かつての監視センター
- システムは部分的に生きている
- プレイヤーは調査員/侵入者

### 1.3 参考レベル

| 作品 | 参考要素 |
|------|----------|
| **Alien: Isolation** | 回廊構造、ベント、隠れ場所 |
| **Inside** | 線形だが探索要素、環境パズル |
| **Resident Evil 2 Remake** | 警察署のレイアウト、キーアイテム |
| **Prey (2017)** | 相互接続されたエリア |

---

## 2. マップ概要

### 2.1 全体構成

```
                        ┌─────────────┐
                        │   深部      │
                        │ (DeepArea)  │
                        └──────┬──────┘
                               │
              ┌────────────────┼────────────────┐
              │                │                │
        ┌─────┴─────┐    ┌─────┴─────┐    ┌─────┴─────┐
        │ 小部屋2   │    │  通路B    │    │ 機械室    │
        │(Room B)   │    │(Corridor B)│   │(Machine)  │
        └─────┬─────┘    └─────┬─────┘    └───────────┘
              │                │
              └────────┬───────┘
                       │
                 ┌─────┴─────┐
                 │メインホール│
                 │(Main Hall) │
                 └─────┬─────┘
                       │
        ┌──────────────┼──────────────┐
        │              │              │
  ┌─────┴─────┐  ┌─────┴─────┐  ┌─────┴─────┐
  │ 小部屋1   │  │  通路A    │  │ 監視室    │
  │(Room A)   │  │(Corridor A)│ │(Security) │
  └───────────┘  └─────┬─────┘  └───────────┘
                       │
                 ┌─────┴─────┐
                 │   入口     │
                 │(Entrance)  │
                 └───────────┘
```

### 2.2 エリアサマリー

| エリア | 面積 | 役割 | Phase |
|--------|------|------|-------|
| 入口 | 8m × 6m | チュートリアル、導入 | 1 |
| 通路A | 20m × 4m | 移動、光回避練習 | 1 |
| メインホール | 20m × 15m | 中央ハブ、イベント | 2 |
| 小部屋1 | 6m × 4m | 撮影対象、リソース | 1-2 |
| 監視室 | 8m × 6m | イベント2の舞台 | 2 |
| 通路B | 15m × 4m | 難易度上昇、パトロール | 2-3 |
| 小部屋2 | 5m × 5m | 隠れ場所、秘密 | 2-3 |
| 機械室 | 10m × 8m | オプション探索 | 2-3 |
| 深部 | 12m × 10m | イベント3、クライマックス | 3 |

---

## 3. エリア詳細設計

### 3.1 入口 (Entrance)

**目的**: ゲームの導入、基本操作の学習

```
┌────────────────────────────┐
│                            │
│    [壊れたカメラ]           │
│         ↓                  │
│    ════════════            │  光の境界線
│         ↓                  │
│    [安全な影]              │
│                            │
│    ★ START                 │
└────────────────────────────┘

寸法: 8m × 6m
天井高: 4m
```

**要素**:
| 要素 | 位置 | 機能 |
|------|------|------|
| 壊れた監視カメラ | 北壁上部 | イベント1のきっかけ |
| スポットライト（故障） | 中央天井 | 初めて光を認識 |
| 入口ドア | 南壁 | スタート位置 |
| 通路Aへのドア | 北壁 | 進行 |
| 古いポスター | 東壁 | 世界観、撮影練習対象 |

**光源配置**:
```cpp
// 入口の光源設定
SpotLight_Entrance.Intensity = 2000.0f;
SpotLight_Entrance.AttenuationRadius = 400.0f;
SpotLight_Entrance.bIsFlickering = true;  // 故障、点滅
SpotLight_Entrance.FlickerInterval = 3.0f;
```

**隠れ場所**: なし（チュートリアルのため）

---

### 3.2 通路A (Corridor A)

**目的**: 光回避の練習、緊張感の構築

```
┌──────────────────────────────────────────────────┐
│ ┌──┐                                        ┌──┐ │
│ │隠│    ○────→────○────→────○            │小│ │
│ │れ│    光1      光2      光3             │部│ │
│ │場│         SAFE      SAFE      SAFE      │屋│ │
│ │所│    ←──────────────────────────────    │1 │ │
│ └──┘                                        └──┘ │
└──────────────────────────────────────────────────┘

寸法: 20m × 4m
天井高: 3m
```

**光源パターン**:
```
時間軸 →
光1: ████░░░░████░░░░████░░░░  (4秒ON, 4秒OFF)
光2: ░░████░░░░████░░░░████░░  (位相ずれ)
光3: ░░░░████░░░░████░░░░████  (位相ずれ)

SAFE = 常に安全なゾーン（影）
```

**要素**:
| 要素 | 位置 | 機能 |
|------|------|------|
| 天井蛍光灯×3 | 等間隔 | パターン光源 |
| 壁の配電盤 | 西壁中央 | 環境装飾 |
| 落ちた椅子 | 東端 | 障害物、隠れ場所ヒント |
| 小部屋1入口 | 東壁南側 | 分岐 |

**隠れ場所**:
| 名称 | 位置 | 容量 | 視認性 |
|------|------|------|--------|
| 配電盤の影 | 西壁中央 | 1人 | 低（見つかりにくい） |

---

### 3.3 メインホール (Main Hall)

**目的**: 中央ハブ、複数経路の選択、イベント発生

```
┌────────────────────────────────────────────┐
│                  [通路B]                    │
│                     │                      │
│  [監視室]←─────────┼─────────→[機械室]      │
│                     │                      │
│         ┌─────────────────────┐           │
│         │                     │           │
│     ○   │   中央オブジェクト   │   ○       │  回転する
│     光  │   (モニター群)       │   光       │  スポットライト
│         │                     │           │
│         └─────────────────────┘           │
│                                            │
│   [隠れ1]                        [隠れ2]   │
│                                            │
│                  [通路A]                    │
└────────────────────────────────────────────┘

寸法: 20m × 15m
天井高: 6m
```

**光源パターン**:
```cpp
// メインホールの回転スポットライト
RotatingSpotLight.RotationSpeed = 10.0f;  // 度/秒
RotatingSpotLight.SweepAngle = 120.0f;    // スイープ角度
RotatingSpotLight.PauseAtEdge = 2.0f;     // 端での停止時間
```

**要素**:
| 要素 | 位置 | 機能 |
|------|------|------|
| モニター群 | 中央 | 視線遮断、雰囲気 |
| 回転スポットライト×2 | 東西天井 | 動的脅威 |
| 崩れたデスク | 南西 | 隠れ場所1 |
| 積まれた箱 | 南東 | 隠れ場所2 |
| 吊り下げられたカメラ | 北壁上部 | イベント3の伏線 |

**隠れ場所**:
| 名称 | 位置 | 容量 | 特徴 |
|------|------|------|------|
| デスク下 | 南西 | 1人 | 光が届きにくい |
| 箱の後ろ | 南東 | 1人 | 視線は遮るが光は通る |
| モニター裏 | 中央 | 1人 | 一時的な遮蔽のみ |

---

### 3.4 小部屋1 (Room A)

**目的**: 撮影練習、証拠アイテム

```
┌────────────────────┐
│  [棚]              │
│                    │
│     [デスク]       │
│     ┌───┐          │
│     │証拠│  ○光    │
│     └───┘          │
│                    │
│  [隠れ場所]        │
│           ←[通路A] │
└────────────────────┘

寸法: 6m × 4m
天井高: 3m
```

**要素**:
| 要素 | 位置 | 機能 |
|------|------|------|
| 古いデスク | 中央北 | 証拠配置場所 |
| 書類（証拠1） | デスク上 | 撮影対象 |
| 壊れた端末 | デスク上 | 環境装飾 |
| 金属棚 | 北壁 | 環境装飾 |
| ロッカー | 南西角 | 隠れ場所 |

**光源**:
- 固定天井灯（弱い、常時ON）
- デスクランプ（プレイヤー操作可能？）

---

### 3.5 監視室 (Security Room)

**目的**: イベント2「残された記録」の舞台

```
┌──────────────────────────────┐
│  ┌─────────────────────┐    │
│  │  モニターウォール    │    │
│  │  (多数の画面)       │    │
│  └─────────────────────┘    │
│                              │
│    [椅子]    [コンソール]    │
│                              │
│  [遺留品]                    │
│  (前の探索者の荷物)          │
│                              │
│    [隠れ場所]     ←[ホール]  │
└──────────────────────────────┘

寸法: 8m × 6m
天井高: 3.5m
```

**イベント2の流れ**:
1. 部屋に入る → モニターがノイズを映す
2. 遺留品を発見 → 撮影でログ取得
3. 撮影完了 → モニターに一瞬何かが映る（演出）

**要素**:
| 要素 | 位置 | 機能 |
|------|------|------|
| モニターウォール | 北壁 | 16画面、ノイズ表示 |
| 操作コンソール | 中央 | 環境装飾、インタラクト不可 |
| 回転椅子 | コンソール前 | 環境装飾 |
| 遺留品（バッグ） | 南西床 | イベント2の撮影対象 |
| コンソール下 | 南壁 | 隠れ場所 |

**光源**:
- モニターからの青い光（主光源）
- 非常灯（赤、弱い）

---

### 3.6 通路B (Corridor B)

**目的**: 難易度上昇、パトロールライト

```
┌────────────────────────────────────────┐
│                                        │
│    ←─────────○──────────────→         │  パトロールする
│              光（移動）                 │  スポットライト
│                                        │
│    [隠れ1]           [隠れ2]           │
│                                        │
│    [ホール]←              →[深部]      │
└────────────────────────────────────────┘

寸法: 15m × 4m
天井高: 3m
```

**パトロールライト**:
```cpp
// 通路Bのパトロールライト
PatrolLight.MoveSpeed = 2.0f;           // m/秒
PatrolLight.PatrolLength = 12.0f;       // 移動距離
PatrolLight.PauseTime = 1.5f;           // 端での停止
PatrolLight.LightRadius = 3.0f;         // 光の半径
```

**隠れ場所**:
| 名称 | 位置 | 安全性 |
|------|------|--------|
| 壁のくぼみ1 | 北壁西側 | 完全（光が届かない） |
| 配管の下 | 南壁東側 | 部分的（タイミング必要） |

---

### 3.7 小部屋2 (Room B)

**目的**: 隠れ場所、オプションの秘密

```
┌────────────────────┐
│                    │
│  [大きな棚]        │
│  (隠れ場所)        │
│                    │
│      [箱]          │
│                    │
│  [秘密のメモ]      │
│                    │
│  ←[通路B]          │
└────────────────────┘

寸法: 5m × 5m
天井高: 3m
```

**要素**:
- ほぼ完全な暗闘
- 棚の後ろに隠れ場所
- オプションの秘密メモ（撮影で取得）

---

### 3.8 機械室 (Machine Room)

**目的**: オプション探索、環境パズル

```
┌────────────────────────────────────┐
│                                    │
│  ┌────┐        ┌────┐             │
│  │機械│        │機械│             │
│  │ A  │        │ B  │             │
│  └────┘        └────┘             │
│                                    │
│        [配電盤]                    │
│        (光源操作?)                 │
│                                    │
│  [隠れ場所]                        │
│                                    │
│                    ←[ホール]       │
└────────────────────────────────────┘

寸法: 10m × 8m
天井高: 5m
```

**将来の拡張ポイント**:
- 配電盤で一時的に光を消せる？
- Night 2以降で重要になる場所

---

### 3.9 深部 (Deep Area)

**目的**: イベント3「覚醒する監視」、クライマックス

```
┌────────────────────────────────────────┐
│                                        │
│    ┌──────────────────────────────┐   │
│    │     メイン監視カメラ          │   │
│    │     (イベント3の中心)         │   │
│    └──────────────────────────────┘   │
│                                        │
│         ○        ○        ○          │  不規則に
│         光       光       光           │  点灯する光
│                                        │
│    [隠れ1]              [隠れ2]        │
│                                        │
│    [最後の証拠]                        │
│                                        │
│              ←[通路B]                   │
└────────────────────────────────────────┘

寸法: 12m × 10m
天井高: 4m
```

**イベント3の演出**:
```cpp
// 覚醒する監視 - 光のパターン
void TriggerSystemAwareness()
{
    // Phase 1: 光が順番に点灯
    for (int i = 0; i < Lights.Num(); i++)
    {
        Lights[i].TurnOnWithDelay(i * 0.5f);
    }

    // Phase 2: ランダム点滅開始
    SetLightPattern(ELightPattern::RandomFlicker);

    // Phase 3: メインカメラが「動く」演出
    MainCamera.PlayAnimation(Anim_CameraActivate);

    // 緊張度を最大に
    SetTensionLevel(1.0f);
}
```

**最後の証拠**:
- 撮影すると「Night 1 Complete」に向かう
- 撮影しなくても夜明けで終了

---

## 4. 光源システム

### 4.1 光源タイプ

| タイプ | 挙動 | 検知力 | 用途 |
|--------|------|--------|------|
| **固定光** | 常時ON | 100% | 基本的な脅威 |
| **点滅光** | ON/OFF繰り返し | ON時100% | タイミングパズル |
| **パトロール光** | 移動 | 100% | 動的脅威 |
| **回転光** | 回転 | 100% | エリア制御 |
| **反応光** | プレイヤーに反応 | 100% | 高難度 |

### 4.2 安全ゾーンの配置ルール

```
最小安全ゾーン間隔: 5m
最小安全ゾーンサイズ: 2m × 2m
光源から安全ゾーンまでの距離: 最低3m

配置パターン:
[光] ─ 3m ─ [SAFE] ─ 3m ─ [光] ─ 3m ─ [SAFE]
```

### 4.3 難易度曲線による光源密度

| Phase | 光源密度 | 安全ゾーン | 隠れ場所 |
|-------|---------|-----------|---------|
| Phase 1 (導入) | 低 | 多い | 見つけやすい |
| Phase 2 (緩和) | 中 | 適度 | 適度 |
| Phase 3 (締め) | 高 | 少ない | 少ない |

---

## 5. 隠れ場所システム

### 5.1 隠れ場所タイプ

| タイプ | 例 | 入る時間 | 安全性 | 視認性 |
|--------|-----|---------|--------|--------|
| **完全遮蔽** | ロッカー内 | 1.5秒 | 100% | 見えない |
| **部分遮蔽** | デスク下 | 0.5秒 | 80% | 足が見える |
| **一時遮蔽** | 柱の影 | 0秒 | 60% | 動くと見える |

### 5.2 配置ルール

```
各エリアの隠れ場所数:
- 小エリア (< 30㎡): 1-2箇所
- 中エリア (30-100㎡): 2-3箇所
- 大エリア (> 100㎡): 3-4箇所

配置原則:
1. 光源から5m以内に最低1箇所
2. 進行ルート上に最低1箇所
3. デッドエンドには必ず1箇所
```

### 5.3 隠れ場所一覧

| エリア | 名称 | タイプ | 座標メモ |
|--------|------|--------|---------|
| 通路A | 配電盤の影 | 部分遮蔽 | 西壁中央 |
| メインホール | デスク下 | 部分遮蔽 | 南西 |
| メインホール | 箱の後ろ | 一時遮蔽 | 南東 |
| 小部屋1 | ロッカー | 完全遮蔽 | 南西角 |
| 監視室 | コンソール下 | 部分遮蔽 | 南壁 |
| 通路B | 壁のくぼみ | 完全遮蔽 | 北壁西 |
| 通路B | 配管下 | 部分遮蔽 | 南壁東 |
| 小部屋2 | 棚の後ろ | 完全遮蔽 | 北壁 |
| 深部 | 機器の影1 | 部分遮蔽 | 西側 |
| 深部 | 機器の影2 | 部分遮蔽 | 東側 |

---

## 6. 撮影ポイント

### 6.1 必須撮影対象

| 対象 | エリア | 種類 | イベント |
|------|--------|------|---------|
| 壊れたカメラ | 入口 | 証拠 | イベント1 |
| 遺留品 | 監視室 | 証拠 | イベント2 |
| 最後の証拠 | 深部 | 証拠 | イベント3 |

### 6.2 オプション撮影対象

| 対象 | エリア | 種類 | 報酬 |
|------|--------|------|------|
| 古いポスター | 入口 | 世界観 | ログ |
| 書類 | 小部屋1 | ヒント | ログ |
| 秘密のメモ | 小部屋2 | 秘密 | ログ |
| モニター画面 | 監視室 | 世界観 | ログ |

---

## 7. プレイヤー動線

### 7.1 メインルート（想定）

```
入口 → 通路A → メインホール → 監視室(イベント2)
                    ↓
              通路B → 深部(イベント3) → 終了
```

**想定プレイ時間**: 12-15分

### 7.2 探索ルート（オプション）

```
メインホールから分岐:
├─ 小部屋1 (撮影練習、証拠)
├─ 機械室 (将来の伏線)
└─ 小部屋2 (秘密、隠れ場所)
```

**追加探索時間**: +3-5分

### 7.3 緊急脱出ルート

各エリアには必ず2つ以上の出口を用意:
- メインホール: 4方向
- 通路: 両端
- 小部屋: 1方向だが近くに隠れ場所

---

## 8. 技術仕様

### 8.1 World Partition設定

```cpp
// ストリーミング設定
WorldPartition.CellSize = 12800;  // 128m
WorldPartition.LoadingRange = 25600;  // 256m

// サブレベル構成
L_Night1_Persistent   // 常駐
├── L_Night1_Entrance    // 入口
├── L_Night1_CorridorA   // 通路A
├── L_Night1_MainHall    // メインホール
├── L_Night1_RoomA       // 小部屋1
├── L_Night1_Security    // 監視室
├── L_Night1_CorridorB   // 通路B
├── L_Night1_RoomB       // 小部屋2
├── L_Night1_Machine     // 機械室
└── L_Night1_DeepArea    // 深部
```

### 8.2 ライティング設定

```cpp
// Night 1 基本ライティング
DirectionalLight.Intensity = 0.0f;  // 太陽光なし
SkyLight.Intensity = 0.1f;          // 最小限の環境光
PostProcess.AutoExposure.MinBrightness = 0.5f;
PostProcess.AutoExposure.MaxBrightness = 2.0f;
```

### 8.3 コリジョン設定

```cpp
// プレイヤーコリジョン
Player.CapsuleRadius = 35.0f;   // 70cm幅
Player.CapsuleHalfHeight = 88.0f;  // 176cm高

// 隠れ場所判定
HideSpot.TriggerBox = FVector(100, 100, 180);  // 1m×1m×1.8m
```

---

## 9. 実装優先順位

### Phase 1: グレーボックス
- [ ] 全エリアの基本形状
- [ ] コリジョン設定
- [ ] プレイヤー動線確認
- [ ] 基本ライティング

### Phase 2: 光源システム
- [ ] 固定光源配置
- [ ] 点滅光源実装
- [ ] パトロールライト実装
- [ ] 回転ライト実装

### Phase 3: 隠れ場所
- [ ] 隠れ場所トリガー配置
- [ ] 隠れるアニメーション連携
- [ ] 安全判定実装

### Phase 4: イベント統合
- [ ] イベント1配置（入口）
- [ ] イベント2配置（監視室）
- [ ] イベント3配置（深部）
- [ ] 撮影ポイント配置

### Phase 5: ポリッシュ
- [ ] 環境アート追加
- [ ] サウンド連携
- [ ] VFX追加
- [ ] 最終調整

---

## Appendix: グレーボックスアセット

### モジュラー壁セット

| アセット | サイズ | 用途 |
|----------|--------|------|
| SM_Wall_4m | 4m × 3m | 標準壁 |
| SM_Wall_4m_Door | 4m × 3m | ドア付き壁 |
| SM_Wall_4m_Window | 4m × 3m | 窓付き壁 |
| SM_Wall_2m | 2m × 3m | 短い壁 |
| SM_Corner_Inner | 0.1m | 内角 |
| SM_Corner_Outer | 0.1m | 外角 |

### フロアセット

| アセット | サイズ | 用途 |
|----------|--------|------|
| SM_Floor_4x4 | 4m × 4m | 標準床 |
| SM_Floor_2x2 | 2m × 2m | 小さい床 |
| SM_Floor_4x4_Grate | 4m × 4m | グレーチング床 |

### 天井セット

| アセット | サイズ | 用途 |
|----------|--------|------|
| SM_Ceiling_4x4 | 4m × 4m | 標準天井 |
| SM_Ceiling_4x4_Light | 4m × 4m | ライト付き |
| SM_Ceiling_4x4_Vent | 4m × 4m | 通気口付き |

---

**Document Status**: Draft
**Next Review**: グレーボックス完成後
